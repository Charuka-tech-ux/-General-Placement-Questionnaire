<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ManikShan Placement Questionnaire</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .form-container {
            max-width: 900px;
            margin: 1rem auto;
            padding: 1.5rem;
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        @media (min-width: 768px) {
            .form-container {
                margin: 3rem auto;
                padding: 2.5rem;
            }
        }
        h1, h2 {
            color: #1f2937;
        }
        .form-group label {
            font-weight: 600;
        }
        input[type="text"], input[type="email"], input[type="tel"], textarea, select {
            transition: all 0.2s;
        }
        input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, textarea:focus, select:focus {
            border-color: #2563eb;
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.5);
        }
        .conditional-input {
            margin-top: 0.75rem;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<div id="pdf-content" class="form-container">
    <header class="text-center mb-8">
        <h1 class="text-3xl font-bold uppercase tracking-wider text-blue-700">ManikShan Foreign Employment PVT LTD</h1>
        <h3 class="text-2xl font-bold border-b-2 pb-2 mb-8 text-gray-700">GENERAL PLACEMENT QUESTIONNAIRE</h3>
    </header>

    <form id="placementForm" class="space-y-6">
        <!-- Personal Information -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 border-b pb-4 mb-4">
            <div class="form-group">
                <label for="name" class="block text-sm text-gray-700 mb-1">Name <span class="text-red-500">*</span></label>
                <input type="text" id="name" name="name" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none" required>
            </div>
            <div class="form-group">
                <label for="email" class="block text-sm text-gray-700 mb-1">Email Address <span class="text-red-500">*</span></label>
                <input type="email" id="email" name="email" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none" required>
            </div>
            <div class="form-group">
                <label for="phone" class="block text-sm text-gray-700 mb-1">Phone Number</label>
                <input type="tel" id="phone" name="phone" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none">
            </div>
        </div>

        <!-- Referral Information -->
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">How did you hear about ManikShan Foreign Employment?</label>
            <div class="flex flex-wrap gap-4">
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="Referral" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Referral</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="School" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">School</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="LinkedIn" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">LinkedIn</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="ManikShan Website" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">ManikShan Website</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="Facebook/Instagram" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Facebook/Instagram</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="HOSCO" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">HOSCO</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="hear_about" value="Other" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Other</span></label>
            </div>
            <div id="other_source_input" class="conditional-input hidden"><input type="text" id="other_source" name="other_source" placeholder="Please specify the source" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group border-b pb-4 mb-4">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Were you referred by someone?</label>
            <div class="flex items-center gap-4">
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="referred" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="referred" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label>
            </div>
            <div id="referred_yes_name_input" class="conditional-input hidden"><input type="text" id="referred_yes_name" name="referred_yes_name" placeholder="If yes, who?" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>

        <!-- Program & Agency Details -->
        <h4 class="text-lg font-bold text-blue-600 border-b border-gray-200 pb-2 mt-6 mb-4">Program & Agency Details</h4>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Program Fee Acknowledgement. I confirm I have reviewed and understand the program fees,
including the payment schedule and due dates: </label>
            <div class="flex flex-wrap gap-4">
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="fee_acknowledgement" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="fee_acknowledgement" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label>
            </div>
            <div id="fee_no_reason_input" class="conditional-input hidden"><input type="text" id="fee_no_reason" name="fee_no_reason" placeholder="If no, please explain" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group border-b pb-4 mb-4">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Are you working with any other Agency?</label>
            <div class="flex flex-wrap gap-4">
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="other_agency" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label>
                <label class="inline-flex items-center cursor-pointer"><input type="radio" name="other_agency" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label>
            </div>
            <div id="agency_yes_name_input" class="conditional-input hidden"><input type="text" id="agency_yes_name" name="agency_yes_name" placeholder="If yes, what agency and what fees are you required to pay?" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>

        <!-- Placement Preferences -->
        <h4 class="text-lg font-bold text-blue-600 border-b border-gray-200 pb-2 mt-6 mb-4">PLACEMENT PREFERENCES</h4>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Desired Position:</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <select id="position_1" name="position_1" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required><option value="" disabled selected>Select 1st Preference</option><option value="Food & Beverage">Food & Beverage</option><option value="Culinary">Culinary</option><option value="Front Office">Front Office</option><option value="Housekeeping Supervisor">Housekeeping Supervisor</option><option value="Business Administration">Business Administration</option><option value="Business Administration">Other</option></select>
                <select id="position_2" name="position_2" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required><option value="" disabled selected>Select 2nd Preference</option><option value="Food & Beverage">Food & Beverage</option><option value="Culinary">Culinary</option><option value="Front Office">Front Office</option><option value="Housekeeping Supervisor">Housekeeping Supervisor</option><option value="Business Administration">Business Administration</option><option value="Business Administration">Other</option></select>
            </div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-1 font-semibold">Desired Arrival Date (month/year):</label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <select id="arrival_month" name="arrival_month" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required>
                    <option value="" disabled selected>Select Month</option>
                    <option value="January">January</option>
                    <option value="February">February</option>
                    <option value="March">March</option>
                    <option value="April">April</option>
                    <option value="May">May</option>
                    <option value="June">June</option>
                    <option value="July">July</option>
                    <option value="August">August</option>
                    <option value="September">September</option>
                    <option value="October">October</option>
                    <option value="November">November</option>
                    <option value="December">December</option>
                </select>
                <select id="arrival_year" name="arrival_year" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required>
                    <option value="" disabled selected>Select Year</option>
                    <option value="2025">2025</option>
                    <option value="2026">2026</option>
                    <option value="2027">2027</option>
                    <option value="2028">2028</option>
                    <option value="2029">2029</option>
                    <option value="2030">2030</option>
                </select>
            </div>
        </div>
        <div class="form-group"><label class="block text-sm text-gray-700 mb-2 font-semibold">Program Length:</label><div class="flex flex-wrap gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="program_length" value="6 months" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">6 months</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="program_length" value="9 months" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">9 months</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="program_length" value="12 months" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">12 months</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="program_length" value="18 months" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">18 months</span></label></div></div>
        <div class="form-group border-b pb-4 mb-4"><label class="block text-sm text-gray-700 mb-2 font-semibold">Location Preference:</label><div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="location_preference" value="100% open to ALL locations" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">100% open to ALL locations</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="location_preference" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div><div id="preferred_locations_input" class="conditional-input hidden"><input type="text" id="preferred_locations" name="preferred_locations" placeholder="If no, preferred location(s)" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div><div id="charger_message_input" class="conditional-input hidden text-sm text-green-700 font-medium p-2 bg-green-50 rounded-lg mt-2">(Additional charges will be added.)</div></div>

        <!-- Skills & Health Information -->
        <h4 class="text-lg font-bold text-blue-600 border-b border-gray-200 pb-2 mt-6 mb-4">SKILLS & HEALTH INFORMATION</h4>
        <div class="form-group"><label for="english_speaking" class="block text-sm text-gray-700 mb-1 font-semibold">English Speaking Level (1-10):</label><select id="english_speaking" name="english_speaking" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required><option value="" disabled selected>Select a rating</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></div>
        <div class="form-group"><label for="english_writing" class="block text-sm text-gray-700 mb-1 font-semibold">English Writing Level (1-10):</label><select id="english_writing" name="english_writing" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required><option value="" disabled selected>Select a rating</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></div>
        <div class="form-group"><label for="teamwork" class="block text-sm text-gray-700 mb-1 font-semibold">Able to work well with others (1-10):</label><select id="teamwork" name="teamwork" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none bg-white" required><option value="" disabled selected>Select a rating</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select></div>
        <div class="form-group border-t pt-6 mt-4"><label class="block text-sm text-gray-700 mb-2 font-semibold">Are you vaccinated?</label><div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="vaccinated" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="vaccinated" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div><div id="vaccinated_yes_input" class="conditional-input hidden"><input type="text" id="vaccine_name" name="vaccine_name" placeholder="If yes, what vaccine?" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div><div id="vaccinated_no_input" class="conditional-input hidden"><label class="block text-sm text-gray-700 mt-2 mb-2 font-semibold">If not, are you willing to get vaccinated?</label><div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="willing_to_vaccinate" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="willing_to_vaccinate" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div></div></div>

        <!-- Background Information -->
        <h4 class="text-lg font-bold text-blue-600 border-b border-gray-200 pb-2 mt-6 mb-4">BACKGROUND INFORMATION</h4>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Do you want a Custom Placement with another candidate?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="custom_placement" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="custom_placement" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="custom_placement_yes_input" class="conditional-input hidden"><input type="text" id="custom_placement_details" name="custom_placement_details" placeholder="If yes, what is the full name of the other candidate?" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Have you ever trained/worked in the USA?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="trained_in_usa" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="trained_in_usa" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="trained_in_usa_yes_input" class="conditional-input hidden"><input type="text" id="trained_in_usa_details" name="trained_in_usa_details" placeholder="If yes, when & what type of Visa did you receive?" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Do you have any family that resides in the USA?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="family_in_usa" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="family_in_usa" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="family_in_usa_yes_input" class="conditional-input hidden"><input type="text" id="family_in_usa_details" name="family_in_usa_details" placeholder="If yes, please list their name, relationship, and location" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Do you have any pre-existing medical conditions?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="medical_conditions" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="medical_conditions" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="medical_conditions_yes_input" class="conditional-input hidden"><input type="text" id="medical_conditions_details" name="medical_conditions_details" placeholder="If yes, what" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Are you currently under a doctor’s care?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="doctors_care" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="doctors_care" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="doctors_care_yes_input" class="conditional-input hidden"><input type="text" id="doctors_care_details" name="doctors_care_details" placeholder="If yes, what" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Have you ever been arrested or convicted of a crime?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="arrested_convicted" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="arrested_convicted" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="arrested_convicted_yes_input" class="conditional-input hidden"><input type="text" id="arrested_convicted_details" name="arrested_convicted_details" placeholder="If yes, what" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>
        <div class="form-group">
            <label class="block text-sm text-gray-700 mb-2 font-semibold">Have you ever been denied a US Visa or denied entry into the USA?</label>
            <div class="flex items-center gap-4"><label class="inline-flex items-center cursor-pointer"><input type="radio" name="visa_denied" value="Yes" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">Yes</span></label><label class="inline-flex items-center cursor-pointer"><input type="radio" name="visa_denied" value="No" class="form-radio text-blue-600 h-4 w-4"><span class="ml-2 text-gray-600">No</span></label></div>
            <div id="visa_denied_yes_input" class="conditional-input hidden"><input type="text" id="visa_denied_details" name="visa_denied_details" placeholder="If yes, what" class="w-full p-2 border border-gray-300 rounded-lg focus:outline-none"></div>
        </div>

        <!-- Submit Button -->
        <div class="mt-8 text-center"><button type="button" onclick="generatePDF()" class="px-8 py-3 bg-blue-600 text-white font-semibold rounded-full shadow-xl hover:bg-blue-700 transition duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-blue-300">Download Completed Questionnaire as PDF</button></div>
    </form>
</div>

<script>
    const { jsPDF } = window.jspdf;

    /**
     * Sets up listeners for radio buttons to show/hide conditional input fields.
     */
    function setupConditionalInput(radioGroupName, conditionalValue, conditionalInputId) {
        const radioButtons = document.querySelectorAll(`input[name="${radioGroupName}"]`);
        const conditionalInput = document.getElementById(conditionalInputId);
        
        radioButtons.forEach(radio => {
            radio.addEventListener('change', () => {
                const isCheckedAndMatches = radio.checked && radio.value === conditionalValue;
                if (isCheckedAndMatches) {
                    conditionalInput.classList.remove('hidden');
                } else {
                    const currentlyChecked = document.querySelector(`input[name="${radioGroupName}"]:checked`);
                    if (!currentlyChecked || currentlyChecked.value !== conditionalValue) {
                         conditionalInput.classList.add('hidden');
                    }
                }
            });
        });
    }

    /**
     * Initializes all form event listeners on page load.
     */
    function initializeFormListeners() {
        setupConditionalInput('hear_about', 'Other', 'other_source_input');
        setupConditionalInput('referred', 'Yes', 'referred_yes_name_input'); 
        setupConditionalInput('fee_acknowledgement', 'No', 'fee_no_reason_input');
        setupConditionalInput('other_agency', 'Yes', 'agency_yes_name_input'); 
        setupConditionalInput('location_preference', 'No', 'preferred_locations_input');
        setupConditionalInput('location_preference', 'No', 'charger_message_input');
        setupConditionalInput('vaccinated', 'Yes', 'vaccinated_yes_input');
        setupConditionalInput('vaccinated', 'No', 'vaccinated_no_input');

        // Listeners for background information
        setupConditionalInput('custom_placement', 'Yes', 'custom_placement_yes_input');
        setupConditionalInput('trained_in_usa', 'Yes', 'trained_in_usa_yes_input');
        setupConditionalInput('family_in_usa', 'Yes', 'family_in_usa_yes_input');
        setupConditionalInput('medical_conditions', 'Yes', 'medical_conditions_yes_input');
        setupConditionalInput('doctors_care', 'Yes', 'doctors_care_yes_input');
        setupConditionalInput('arrested_convicted', 'Yes', 'arrested_convicted_yes_input');
        setupConditionalInput('visa_denied', 'Yes', 'visa_denied_yes_input');
    }

    document.addEventListener('DOMContentLoaded', initializeFormListeners);

    /**
     * Helper function to get the value of a checked radio button in a group.
     */
    function getRadioValue(form, name) {
        const checked = form.querySelector(`input[name="${name}"]:checked`);
        return checked ? checked.value : 'N/A';
    }
    
    /**
     * Helper function to get the value of a text or select element.
     */
    function getValue(id) {
        return document.getElementById(id)?.value.trim() || 'Not provided';
    }

    /**
     * Collects all form data into a structured array for PDF generation.
     */
    function collectFormData() {
        const data = [];
        const form = document.getElementById('placementForm');

        // Helper to process conditional 'Yes' answers
        const processYesNoQuestion = (question, radioName, detailsId) => {
            const radioValue = getRadioValue(form, radioName);
            let answer = radioValue;
            if (radioValue === 'Yes') {
                const details = getValue(detailsId);
                answer = details !== 'Not provided' ? `Yes (Details: ${details})` : 'Yes (Details not provided)';
            }
            data.push({ question, answer });
        };

        data.push({ question: 'Name', answer: getValue('name') });
        data.push({ question: 'Email Address', answer: getValue('email') });
        data.push({ question: 'Phone Number', answer: getValue('phone') });

        const hearAboutValue = getRadioValue(form, 'hear_about');
        let finalHearAboutAnswer = hearAboutValue;
        if (hearAboutValue === 'Other') {
            const otherSource = getValue('other_source');
            finalHearAboutAnswer = otherSource !== 'Not provided' ? `Other (${otherSource})` : 'Other (Not specified)';
        }
        data.push({ question: 'How did you hear about ManikShan?', answer: finalHearAboutAnswer });

        processYesNoQuestion('Were you referred by someone?', 'referred', 'referred_yes_name');
        
        const feeAckValue = getRadioValue(form, 'fee_acknowledgement');
        let feeAckAnswer = feeAckValue;
        if (feeAckValue === 'No') {
            const reason = getValue('fee_no_reason');
            feeAckAnswer = reason !== 'Not provided' ? `No (Reason: ${reason})` : 'No (Reason not provided)';
        }
        data.push({ question: 'Program Fee Acknowledgement', answer: feeAckAnswer });

        processYesNoQuestion('Are you working with any other Agency?', 'other_agency', 'agency_yes_name');
        
        data.push({ question: 'Desired Position (1st Preference)', answer: getValue('position_1') });
        data.push({ question: 'Desired Position (2nd Preference)', answer: getValue('position_2') });
        
        const arrivalMonth = getValue('arrival_month');
        const arrivalYear = getValue('arrival_year');
        const arrivalDateAnswer = (arrivalMonth !== 'Not provided' && arrivalYear !== 'Not provided') 
            ? `${arrivalMonth} ${arrivalYear}` 
            : 'Not provided';
        data.push({ question: 'Desired Arrival Date', answer: arrivalDateAnswer });

        data.push({ question: 'Program Length', answer: getRadioValue(form, 'program_length') });

        const locationPrefValue = getRadioValue(form, 'location_preference');
        let finalLocationPref = locationPrefValue;
        if (locationPrefValue === 'No') {
            const preferredLocs = getValue('preferred_locations');
            finalLocationPref = preferredLocs !== 'Not provided' ? `No (Preferences: ${preferredLocs}). Additional charges apply.` : 'No. Additional charges apply.';
        }
        data.push({ question: 'Location Preference', answer: finalLocationPref });

        data.push({ question: 'English Speaking Level (1-10)', answer: getValue('english_speaking') });
        data.push({ question: 'English Writing Level (1-10)', answer: getValue('english_writing') });
        data.push({ question: 'Teamwork Ability (1-10)', answer: getValue('teamwork') });

        const vaccinatedValue = getRadioValue(form, 'vaccinated');
        let vaccinationAnswer = vaccinatedValue;
        if (vaccinatedValue === 'Yes') {
            const vaccineName = getValue('vaccine_name');
            vaccinationAnswer = vaccineName !== 'Not provided' ? `Yes (Vaccine: ${vaccineName})` : 'Yes (Vaccine not specified)';
        } else if (vaccinatedValue === 'No') {
            const willingValue = getRadioValue(form, 'willing_to_vaccinate');
            vaccinationAnswer = willingValue !== 'N/A' ? `No (Willing to get vaccinated: ${willingValue})` : 'No (Willingness not specified)';
        }
        data.push({ question: 'Are you vaccinated?', answer: vaccinationAnswer });

        // Collecting data for background questions
        processYesNoQuestion('Do you want a Custom Placement with another candidate?', 'custom_placement', 'custom_placement_details');
        processYesNoQuestion('Have you ever trained/worked in the USA?', 'trained_in_usa', 'trained_in_usa_details');
        processYesNoQuestion('Do you have any family that resides in the USA?', 'family_in_usa', 'family_in_usa_details');
        processYesNoQuestion('Do you have pre-existing medical conditions?', 'medical_conditions', 'medical_conditions_details');
        processYesNoQuestion('Are you currently under a doctor’s care?', 'doctors_care', 'doctors_care_details');
        processYesNoQuestion('Have you ever been arrested or convicted?', 'arrested_convicted', 'arrested_convicted_details');
        processYesNoQuestion('Have you ever been denied a US Visa?', 'visa_denied', 'visa_denied_details');

        return data;
    }

    /**
     * Generates and downloads the PDF summary of the questionnaire.
     */
    function generatePDF() {
        const form = document.getElementById('placementForm');
        
        if (!form.checkValidity()) {
            form.reportValidity();
            return;
        }

        try {
            const formData = collectFormData();
            const pdf = new jsPDF('p', 'mm', 'a4');
            
            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const margin = 15;
            const maxWidth = pageWidth - (2 * margin);
            let yPosition = margin;

            pdf.setFontSize(20);
            pdf.setFont(undefined, 'bold');
            pdf.setTextColor(37, 99, 235);
            pdf.text('ManikShan Foreign Employment PVT LTD', pageWidth / 2, yPosition, { align: 'center' });
            yPosition += 8;
            pdf.setFontSize(9);
            pdf.setFont(undefined, 'normal');
            pdf.setTextColor(107, 114, 128);
            pdf.text('Generated: ' + new Date().toLocaleString(), pageWidth / 2, yPosition, { align: 'center' });
            yPosition += 5;
            pdf.setDrawColor(37, 99, 235);
            pdf.setLineWidth(1);
            pdf.line(margin, yPosition, pageWidth - margin, yPosition);
            yPosition += 10;

            formData.forEach((item) => {
                if (yPosition > pageHeight - 25) { // Check for page break
                    pdf.addPage();
                    yPosition = margin;
                }

                pdf.setFontSize(10);
                pdf.setFont(undefined, 'bold');
                pdf.setTextColor(107, 114, 128);
                const questionLines = pdf.splitTextToSize(item.question, maxWidth);
                pdf.text(questionLines, margin, yPosition);
                yPosition += questionLines.length * 5;

                pdf.setFontSize(11);
                pdf.setFont(undefined, 'bold');
                pdf.setTextColor(31, 41, 55);
                const answerLines = pdf.splitTextToSize(String(item.answer), maxWidth); // Ensure answer is a string
                pdf.text(answerLines, margin, yPosition);
                yPosition += answerLines.length * 6;

                yPosition += 3;
                pdf.setDrawColor(229, 231, 235);
                pdf.setLineWidth(0.5);
                pdf.line(margin, yPosition, pageWidth - margin, yPosition);
                yPosition += 8;
            });

            const candidateName = getValue('name');
            const fileName = candidateName !== 'Not provided'
                ? `ManikShan_Placement_Summary_${candidateName.replace(/\s+/g, '_')}.pdf`
                : 'ManikShan_Placement_Summary_Report.pdf';
            
            pdf.save(fileName);
            showMessage('PDF downloaded successfully!', 'success');

        } catch (error) {
            console.error("Error generating PDF:", error);
            showMessage('PDF Generation Failed. Please try again.', 'error');
        }
    }

    /**
     * Shows a temporary message notification (toast).
     */
    function showMessage(message, type) {
        const messageDiv = document.createElement('div');
        messageDiv.className = "fixed top-4 right-4 p-4 rounded-lg shadow-xl z-50 transition-all";
        messageDiv.style.backgroundColor = type === 'success' ? '#10b981' : '#ef4444';
        messageDiv.style.color = 'white';
        messageDiv.innerHTML = `<div class="flex items-center gap-2"><span class="font-semibold">${message}</span><button onclick="this.parentNode.parentNode.remove()" class="ml-4 text-white hover:text-gray-200">✕</button></div>`;
        document.body.appendChild(messageDiv);
        setTimeout(() => { messageDiv.remove(); }, 5000);
    }
</script>

</body>
</html>

